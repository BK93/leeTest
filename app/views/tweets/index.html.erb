<div id="welcome">
 
<table>
	<tr>
		<td width="1%">
			<img alt="img" height="50" width="50" src="<%= current_user.image %>">
		</td>
		<td width="50%">
			<%= form_for @tweet do |f| %>
			  <input class="form-control input-lg" type=<%= f.text_field :content %>
			  <%= f.hidden_field :user_id, :value => current_user.id %>
			  <%= f.hidden_field :image, :value => current_user.image %>

			  <% if @tweet.errors.any? %>
				<%= @tweet.errors.messages[:content][0] %>
			  <% end %>
        </td>
		
		<td width="15%">
			&nbsp
		    <input class="btn btn-primary" name="commit" type="submit" value="tweet">  
		    <% end %>
		</td>
	</tr>
</table>


<h1>twitter!!</h1>

<table class="table table-striped table-hover">
<!-- table class="table table-striped table-hover" -->

   <% @tweets.each do |tweet| %>
		<% tweet.retweets.order("id DESC").each do |retweet| %>
		   <tr class="warning">
			<td>
			   <img alt="img" height="40" width="40" src="<%= retweet.image %>" />
			</td>
			  
			<td>
			   <strong><%= tweet.user.username %></strong>&nbsp&nbsp
			   <%= retweet.created_at %>
			   <br>
			   <span class="label label-warning">retweet</span> &nbsp<%= tweet.content %>
			</td>
			
			<td>
			   <%= link_to tweet_retweet_path(retweet.tweet_id, retweet.id), method: :delete, class: "btn btn-danger", data: { confirm: "Are you sure?" } do %>
				  Delete
			   <% end %>
			</td>
		   </tr>
		<% end %>

		
	   <tr class="info">
		<td width="5%">
		   <img alt="img" height="60" width="60" src="<%= tweet.image %>" />
		</td>
		
		<td width="80%">
		   <strong><%= tweet.user.username %></strong>&nbsp&nbsp
		   <%= tweet.created_at %>
		   <br>
		   <h4>
			 <%= tweet.content %>&nbsp
		   </h4>

		   <span class="label label-info">
			  <%= link_to 'Reply', new_tweet_comment_path(tweet.id, @tweet) %>
		   </span>&nbsp
		   
		   <span class="label label-info">
			  <%= link_to 'Retweet', new_tweet_retweet_path(tweet.id, @tweet) %>
		   </span>&nbsp

		   <span class="label label-info">
			   <% if Like.new.likable_for?(current_user, tweet) %>
				<%= link_to 'Favorite', tweet_like_path(tweet.id, id: tweet.id), :method => :delete %>
			   <% else %>
				<%= link_to 'Favorite', tweet_likes_path(tweet_id: tweet.id), method: :post %>
			   <% end %>
				
			   <%= tweet.likes.count %>
		   </span>
		
		</td>
		  
		<td>
		   <%= link_to tweet_path(tweet.id), method: :delete, class: "btn btn-danger", data: { confirm: "Are you sure?" } do %>
			Delete
		   <% end %>
		</td>
	   </tr>

	  
	   
	   <% tweet.comments.each do |comment| %>
	   <tr class="active">
		<td>
		   <img alt="img" height="40" width="40" src="<%= comment.image %>" />
		</td>
		  
		<td>
		   <strong><%= comment.username %></strong>&nbsp&nbsp
		   <%= comment.created_at %>
		   <br>
		   <span class="label label-default">comment</span> &nbsp<%= comment.comment %>
		</td>
		
		<td>
		   <%= link_to tweet_comment_path(comment.tweet_id, comment.id), method: :delete, class: "btn btn-danger", data: { confirm: "Are you sure?" } do %>
			  Delete
		   <% end %>
		</td>
	   </tr>
	   <% end %>
	   
   <% end %>
</table>

<script>
  $(function() {
		$("input[type=checkbox]").click(function() {
			$.post('tweets/'+$(this).data('tweet_id')+'/likes/'+$(this).data('id')+'/toggle')
		});
  });
</script>
</div>
